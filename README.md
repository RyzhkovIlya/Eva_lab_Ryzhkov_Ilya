# Eva_lab
## Задание:
Реализовать детектор сигареты на изображениях/видео (на выходе - bounding box сигареты).

![00018_out](https://user-images.githubusercontent.com/88197584/141793088-792a95f3-12f3-449e-b631-d8cd36670194.jpg)

## Level 1
 - Обучить модель детектора сигареты (выбрать архитектуру, найти/подготовить данные, обучить). Использовать тестовые данные в обучении не допускается.
 - Реализовать инференс на изображении из командной строки (отрисовать bbox-ы).
 
Пример запуска: python3 detector.py  --source 00001.png 
 
В результате, в текущей папке должен появиться файл 00001_out.png, на котором отрисованы bounding box-ы.

## Level 2
 - Реализовать предикт детектора с отрисовкой в реал-тайме (в отдельном потоке) на видеозаписи.
 
Пример запуска: python3 detector.py  --source video.mp4
 
В результате, должно проигрываться видео с отрисованными bounding box-ами.

## Решение задачи
1. Был собран датасет из 600 фотографий с помощью поисковых систем Яндекс и Google;
2. С помощью сайта [Roboflow](https://roboflow.com/) была проведена аугментация фотографий. После этого количество фотографий увеличилось до 1800;
3. В качестве модели была выбрана Yolov4. В Google Colab модель была обучена и были получены веса;
4. В Visual Code был написан скрипт detector.py, который выполяет задачи, представленные в пунктах Level 1 и Level 2.

## Запуск кода
**python3 detector.py  --source название файла**
